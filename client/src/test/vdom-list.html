<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>List Test</title>
</head>
<body>
<script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
<script type="module">

import {GridRoot,GridCell,GridCol,DocumentContext} from "../test/vdom-list.js"
import {createSyncProviders} from "../main/vdom-core.js"

const {createElement:$,useState} = React

function Text({value}){
    return value
}

function App(){
    const [state,setState] = useState({enableColDrag: true, enableRowDrag: true})
    const {enableColDrag,enableRowDrag} = state


    const exCol = (colKey,priority,maxWidth) => $(GridCol,{
        key: ":"+colKey, colKey, priority, caption: "H"+colKey, minWidth: 4, maxWidth
    })
    const cols = [
        exCol("c0",2, 10),
        exCol("c1",2, 10),
        exCol("c2",1, 10),
        exCol("c3",1, 10),
        exCol("c4",0, 10),
        exCol("c5",0, 10),
        exCol("c6",1, 30),
        exCol("c7",1, 10),
        exCol("c8",2, 10),
        exCol("c9",2, 30),
    ]
    const exCell = rowKey => col => $(GridCell,{
        key: ":"+rowKey+col.key, rowKey, colKey: col.props.colKey,
        children: [$(Text,{value: rowKey+" "+col.props.colKey, key: "text"})]
    })
    const rowKeys = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19].map(k=>"r"+k)
    const listEl = $(GridRoot,{
        key: "list",
        identity: {},
        enableColDrag, enableRowDrag,
        cols,
        children: rowKeys.flatMap(rowKey=>cols.map(exCell(rowKey))),
        rowKeys
    })
    const children = [
        $("button",{key:"rowDrag",onClick:ev=>setState(was=>({...was,enableRowDrag:false}))},"rowDrag"),
        $("button",{key:"colDrag",onClick:ev=>setState(was=>({...was,enableColDrag:false}))},"colDrag"),
        listEl
    ]

    const sender = { enqueue: ()=>{} }
    const ack = null
    return $(DocumentContext.Provider, {value:document},
        createSyncProviders({ sender, ack, children })
    )
}

const containerElement = document.createElement("div")
document.body.appendChild(containerElement)
ReactDOM.render($(App),containerElement)
</script>
<!--
features:
    row drag
    col drag
    col hide
    col expand


todo: resolve tag by key (exists), so remove ':'
-->
</body>
</html>